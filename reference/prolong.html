<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="prolong() is designed to take an \(n \times t\) outcome matrix and an
\(n \times p \times t\) array of covariates and automatically run the
entire processing and model fitting process, returning a list of coefficients
with corresponding variable names."><title>Fit prolong Model — prolong • prolong</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit prolong Model — prolong"><meta property="og:description" content="prolong() is designed to take an \(n \times t\) outcome matrix and an
\(n \times p \times t\) array of covariates and automatically run the
entire processing and model fitting process, returning a list of coefficients
with corresponding variable names."><meta property="og:image" content="https://stevebroll.github.io/prolong/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">prolong</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/prolong.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/prolong-experimental.html">Experimental prolong Functions</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/stevebroll/prolong/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Fit prolong Model</h1>
      <small class="dont-index">Source: <a href="https://github.com/stevebroll/prolong/blob/HEAD/R/prolong.R" class="external-link"><code>R/prolong.R</code></a></small>
      <div class="d-none name"><code>prolong.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>prolong()</code> is designed to take an \(n \times t\) outcome matrix and an
\(n \times p \times t\) array of covariates and automatically run the
entire processing and model fitting process, returning a list of coefficients
with corresponding variable names.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">prolong</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  lambda1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lambda2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lambdar <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  groups <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  foldids <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  optimvals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>Input covariate array, with n rows, p columns, and t slices</p></dd>


<dt>y</dt>
<dd><p>Input response matrix, with n rows and t columns</p></dd>


<dt>lambda1</dt>
<dd><p>Lasso/group lasso parameter, if left <code>NULL</code> this parameter
will be chosen via a cross-validation that keeps each subject's observations
across time points together. It is recommended to save the lambda2 and
lambdar values from the first run of prolong for future runs, since the
optimization step takes the longest</p></dd>


<dt>lambda2</dt>
<dd><p>Laplacian penalty parameter, if left <code>NULL</code> will be chosen along
with lambdar via MLE, see supplementary material in
(Steiner et al. 2022)</p></dd>


<dt>lambdar</dt>
<dd><p>Nuisance parameter, if left <code>NULL</code> will be chosen along with
lambdar via MLE. Added to the the diagonal elements of the laplacian matrix
to get the invertibility required for the MLE</p></dd>


<dt>groups</dt>
<dd><p>Optional pre-specified groups. If <code>NULL</code> or <code>FALSE</code>, lasso will be
used. If left as <code>TRUE</code>, then there will be p groups each containing the
observations across time points</p></dd>


<dt>foldids</dt>
<dd><p>Optional pre-specified foldids for the cv. Should be of length
n. If left <code>NULL</code>, subjects will be automatically split into 5 folds</p></dd>


<dt>optimvals</dt>
<dd><p>Initial values of lambda2 and lambdar to be used by
<code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim()</a></code> for the MLE of lambda2 and lambdar</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list object with S3 class <code>prolong</code></p>


<table class="table table"><tr><td><code>beta</code></td><td><code>p*length(lambda1)</code> matrix of coefficients. Currently, <code>lambda1</code> is chosen via cross-validation and is just a single value</td></tr><tr><td><code>selected</code></td><td>the names of the variables with at least one non-zero coefficient</td></tr><tr><td><code>df</code></td><td>number of non-zero coefficients (out of <code>p*t(t-1)/2</code>, not <code>p</code>)</td></tr><tr><td><code>dim</code></td><td>dimension of full coefficient matrix over <code>lambda1</code> values. Currently, <code>lambda1</code> is chosen via cross-validation and is just a single value</td></tr><tr><td><code>lambda1</code></td><td>sequence of <code>lambda1</code> values used in final <code>gglasso</code>/<code>glmnet</code> call</td></tr><tr><td><code>lambda2</code></td><td><code>lambda2</code> value either passed by user or chosen via MLE, parameter of interest for the network penalty</td></tr><tr><td><code>lambdar</code></td><td><code>lambdar</code> value either passed by user or chosen via MLE, nuisance parameter needed to estimate <code>lambda2</code> via MLE</td></tr><tr><td><code>npasses</code></td><td>total number of iterations summed over <code>lambda1</code> values for final <code>gglasso</code>/<code>glmnet</code> call</td></tr><tr><td><code>jerr</code></td><td>error flag for final <code>gglasso</code>/<code>glmnet</code> call, 0 if no error</td></tr><tr><td><code>group</code></td><td>vector of consecutive integers describing the grouping of coefficients</td></tr><tr><td><code>call</code></td><td>the <code>gglasso</code>/<code>glmnet</code> call that produced this object</td></tr></table></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>First, the data is reshaped into the first-differenced vectorized
\(n(t-1)\) length Y and first-differenced matricized \(n(t-1) \times
pt(t-1)/2\) X with a corresponding dependence matrix.
Next, hyperparameters for the graph laplacian-based network
penalty are found via MLE and the parameter for lasso/group lasso is found
via a careful implementation of cross-validation.
Lastly, a group lasso + laplacian or lasso + laplacian model is implemented,
and its bias-adjusted coefficients are returned.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Steiner A, Abbas K, Brzyski D, Pączek K, Randolph TW, Goñi J, Harezlak J (2022).
“Incorporation of spatial- and connectivity-based cortical brain region information in regularized regression: Application to Human Connectome Project data.”
<em>Frontiers in Neuroscience</em>, <b>16</b>.
ISSN 1662-453X, <a href="https://doi.org/10.3389/fnins.2022.957282" class="external-link">doi:10.3389/fnins.2022.957282</a>
, <a href="https://www.frontiersin.org/articles/10.3389/fnins.2022.957282" class="external-link">https://www.frontiersin.org/articles/10.3389/fnins.2022.957282</a>.

Yang Y, Zou H (2015).
“A fast unified algorithm for solving group-lasso penalize learning problems.”
<em>Statistics and Computing</em>, <b>25</b>(6), 1129--1141.
ISSN 1573-1375, <a href="https://doi.org/10.1007/s11222-014-9498-5" class="external-link">doi:10.1007/s11222-014-9498-5</a>
, <a href="2022-09-06">2022-09-06</a>.

Yuan M, Lin Y (2005).
“Model Selection and Estimation in Regression with Grouped Variables.”
<em>Journal of the Royal Statistical Society Series B: Statistical Methodology</em>, <b>68</b>(1), 49-67.
ISSN 1369-7412, <a href="https://doi.org/10.1111/j.1467-9868.2005.00532.x" class="external-link">doi:10.1111/j.1467-9868.2005.00532.x</a>
.

Friedman J, Tibshirani R, Hastie T (2010).
“Regularization Paths for Generalized Linear Models via Coordinate Descent.”
<em>Journal of Statistical Software</em>, <b>33</b>(1), 1--22.
<a href="https://doi.org/10.18637/jss.v033.i01" class="external-link">doi:10.18637/jss.v033.i01</a>
.

Tibshirani R (1996).
“Regression Shrinkage and Selection via the Lasso.”
<em>Journal of the Royal Statistical Society. Series B (Methodological)</em>, <b>58</b>(1), 267--288.
ISSN 00359246, <a href="http://www.jstor.org/stable/2346178" class="external-link">http://www.jstor.org/stable/2346178</a>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">promod</span> <span class="op">&lt;-</span> <span class="fu">prolong</span><span class="op">(</span><span class="va">Ymatrix</span>, <span class="va">Xarray</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">promod</span><span class="op">$</span><span class="va">beta</span></span></span>
<span class="r-in"><span><span class="va">promod</span><span class="op">$</span><span class="va">selected</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">promod</span> <span class="op">&lt;-</span> <span class="fu">prolong</span><span class="op">(</span><span class="va">Ymatrix</span>, <span class="va">Xarray</span>, lambda2 <span class="op">=</span> <span class="fl">.001</span>, lambdar <span class="op">=</span> <span class="fl">10</span>, groups <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">promod</span><span class="op">$</span><span class="va">beta</span></span></span>
<span class="r-in"><span><span class="va">promod</span><span class="op">$</span><span class="va">selected</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Steve Broll.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

